{% extends "base.html" %}
{% load static %}
{% block title %}Orders Received{% endblock %}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'users/restaurant-order-list.css' %}">
{% endblock %}
{% block content %}
<div class="container py-5">
  <h1 class="fw-bold mb-4 text-center">Orders Received</h1>
  <div class="table-responsive">
    <table class="table order-table restaurant-order-list">
      <thead>
        <tr>
          <th scope="col">ID</th>
          <th scope="col">Customer</th>
          <th scope="col">Status</th>
          <th scope="col">Total</th>
          <th scope="col">Created At</th>
          <th scope="col">Instructions</th>
        </tr>
      </thead>
      <tbody>
        {% for order in orders %}
        <tr>
          <td>
            <a href="{% url 'restaurant_order_detail' order.id %}" class="btn btn-link btn-sm">#{{ order.id }}</a>
          </td>
          <td>{{ order.customer.username }}</td>
          <td>
            <form method="post" action="{% url 'restaurant_orders_list' %}" class="d-inline">
              {% csrf_token %}
              <select name="status" class="form-select form-select-sm order-status-dropdown" onchange="this.form.submit()">
                {% for key, value in order.STATUS_CHOICES %}
                  <option value="{{ key }}" {% if order.status == key %}selected{% endif %}>{{ value }}</option>
                {% endfor %}
              </select>
              <input type="hidden" name="order_id" value="{{ order.id }}">
            </form>
            <span class="order-status restaurant-order-list {{ order.status|lower|slugify }} ms-2">{{ order.get_status_display }}</span>
          </td>
          <td>{{ order.total_price|floatformat:2 }} â‚¬</td>
          <td>{{ order.created_at|date:"SHORT_DATETIME_FORMAT" }}</td>
          <td>{{ order.special_instructions|default:"-" }}</td>
          <td>
            <a href="{% url 'restaurant_order_detail' order.id %}" class="btn btn-outline-primary btn-sm">View</a>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="6" class="text-center text-muted">No orders received yet.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
