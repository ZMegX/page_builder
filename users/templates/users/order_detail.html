{% extends "base.html" %}
{% load static %}
{% load math_filters %}
{% block title %}Order Details{% endblock %}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'users/customers-order-detail.css' %}">
{% endblock %}
{% block content %}
<div class="container py-5">
  <h1 class="fw-bold mb-4 text-center">Order #{{ order.id }}</h1>
  <div class="order-detail-card customers-order-detail">
    <div class="row mb-3">
      <div class="col-md-6">
        <h5>Restaurant</h5>
        <p class="mb-1 fw-bold">{{ order.restaurant.name }}</p>
        <p class="mb-1 text-muted"><i class="bi bi-geo-alt me-1"></i>{{ order.restaurant.addresses.first.formatted_address }}</p>
      </div>
      <div class="col-md-6 text-md-end">
        <h5>Status</h5>
        <span class="order-status customers-order-detail {{ order.status|lower|slugify }}">{{ order.get_status_display }}</span>
        <p class="mb-1 mt-2"><strong>Date:</strong> {{ order.created_at|date:"SHORT_DATETIME_FORMAT" }}</p>
      </div>
    </div>
    <div class="table-responsive">
      <table class="table order-items-table customers-order-detail">
        <thead>
          <tr>
            <th>Item</th>
            <th>Qty</th>
            <th>Unit Price</th>
            <th>Total</th>
          </tr>
        </thead>
        <tbody>
          {% for item in order.order_items.all %}
          <tr>
            <td>{{ item.menu_item.name }}</td>
            <td>{{ item.quantity }}</td>
            <td>{{ item.price|floatformat:2 }} €</td>
            <td>{{ item.price|mul:item.quantity|floatformat:2 }} €</td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="4" class="text-center text-muted">No items found.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    <div class="row mt-4">
      <div class="col-md-6">
        <h5>Delivery Address</h5>
        <p>{{ order.delivery_address|default:"Pickup" }}</p>
      </div>
      <div class="col-md-6 text-md-end">
  <h5 class="mb-1">Total</h5>
  <p class="fs-4 fw-bold">{{ order.total_price|floatformat:2 }} €</p>
      </div>
    </div>
  </div>
  <a href="{% url 'order_list' %}" class="btn btn-outline-secondary">Back to Orders</a>
</div>
{% endblock %}